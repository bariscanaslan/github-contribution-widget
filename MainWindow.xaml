<Window x:Class="GitHubContributionWidget.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
        xmlns:tb="http://www.hardcodet.net/taskbar"
        Title="GitHub Widget" 
        Height="200" 
        MinWidth="400"
        MaxWidth="1200"
        SizeToContent="Width"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="False"
        ResizeMode="NoResize"
        ShowInTaskbar="False"
        MouseLeftButtonDown="Window_MouseLeftButtonDown">

    <Grid>
        <tb:TaskbarIcon x:Name="TrayIcon"
                       IconSource="icon.ico"
                       ToolTipText="GitHub Contribution Widget"
                       Visibility="Visible">
            <tb:TaskbarIcon.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Show/Hide" Click="ToggleWindow_Click"/>
                    <MenuItem Header="Refresh" Click="Refresh_Click"/>
                    <Separator/>
                    <MenuItem Header="Exit" Click="Exit_Click"/>
                </ContextMenu>
            </tb:TaskbarIcon.ContextMenu>
        </tb:TaskbarIcon>

        <!-- Main -->
        <Border Background="Transparent"
                CornerRadius="15"
                ClipToBounds="True">
            <Border Background="#1E1E1E" 
                    CornerRadius="15" 
                    BorderBrush="#2D2D2D" 
                    BorderThickness="1"
                    Padding="20">
                <Border.Effect>
                    <DropShadowEffect Color="Black" 
                                    Direction="270" 
                                    ShadowDepth="5" 
                                    BlurRadius="15" 
                                    Opacity="0.0"/>
                </Border.Effect>

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Header -->
                    <Grid Grid.Row="0" Margin="0,0,0,15" MinWidth="350">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="Days I " 
                                      Foreground="#CCCCCC" 
                                      FontSize="24"
                                      FontWeight="SemiBold"/>
                            <TextBlock Text="Code" 
                                      Foreground="#C792EA" 
                                      FontSize="24"
                                      FontWeight="Bold"
                                      Margin="5,0,0,0"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" 
                                   HorizontalAlignment="Right"
                                   VerticalAlignment="Center">
                            <TextBlock x:Name="ContributionCount"
                                      Text="0"
                                      Foreground="#40C463" 
                                      FontSize="20"
                                      FontWeight="Bold"
                                      Margin="0,0,5,0"/>
                            <TextBlock Text="contributions" 
                                      Foreground="#888888" 
                                      FontSize="14"
                                      VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- Close Button -->
                        <Button Content="✕"
                               HorizontalAlignment="Right"
                               VerticalAlignment="Top"
                               Margin="0,-15,-15,0"
                               Width="24"
                               Height="24"
                               Background="Transparent"
                               Foreground="#888888"
                               BorderThickness="0"
                               FontSize="14"
                               Cursor="Hand"
                               Click="CloseButton_Click">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Foreground" Value="#FF4444"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                    </Grid>

                    <!-- Username -->
                    <TextBlock Grid.Row="1" 
                              x:Name="UsernameText"
                              Text=""
                              Foreground="#888888" 
                              FontSize="12"
                              Margin="0,0,0,10"/>

                    <!-- Contribution Calendar -->
                    <ScrollViewer Grid.Row="2" 
                                 HorizontalScrollBarVisibility="Auto"
                                 VerticalScrollBarVisibility="Disabled">
                        <Canvas x:Name="ContributionCanvas"
                               Height="150"
                               Background="Transparent"/>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Border>
    </Grid>
</Window>